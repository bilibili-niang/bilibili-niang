"use strict";(self.webpackChunkblogfront=self.webpackChunkblogfront||[]).push([[232],{6819:function(e,l,a){a.r(l),a.d(l,{alert:function(){return u},fun:function(){return n}});var t=a(2181);const u=(e,l=0)=>{(0,t.xf)(e)},n={splice(e,l=30){return e?e.length>l?e.substring(0,l)+"...":e:null},alert:u}},1232:function(e,l,a){a.r(l),a.d(l,{default:function(){return g}});var t=a(3396),u=a(2483),n=a(4870),o=a(6819);const d={class:"upload"};l={__name:"imgUpload",props:{data:{type:Object,default:{}},action:{type:String,require:!0}},emits:["result"],setup(e,{emit:l}){const a=l,u=e=>{e.success&&a("result",e.result)},i=(0,n.qj)({token:null==JSON.parse(localStorage.getItem("userInfo"))?"":JSON.parse(localStorage.getItem("userInfo")).token}),m=[],c=(e,l)=>{},r=e=>{},s=(e,l)=>{o.fun.alert(`Cancel the transfer of ${e.name} ?`)};return(l,a)=>{const n=(0,t.up)("el-button");var o=(0,t.up)("el-upload");return(0,t.wg)(),(0,t.iD)("div",d,[(0,t.Wm)(o,{"file-list":m,"onUpdate:fileList":a[0]||(a[0]=e=>m=e),class:"upload-demo",action:e.action,data:e.data,headers:i,"on-success":u,"on-preview":r,"on-remove":c,"before-remove":s},{default:(0,t.w5)((()=>[(0,t.Wm)(n,null,{default:(0,t.w5)((()=>[(0,t.Uk)("upload")])),_:1})])),_:1},8,["action","data","headers"])])}}};var i=a(89),m=(0,i.Z)(l,[["__scopeId","data-v-8e7221b6"]]),c=a(2181),r=a(9324),s=a(1827);const v={key:0,class:"articleEdit"},f={class:"demo-image__lazy"},w=["onClick"],p={key:1};var g=(0,i.Z)({__name:"Vedit",setup(e){const l=(0,n.iH)(0),a=(0,n.iH)({content:"> hello world!\ntype you first line code\n",title:"请输入你的标题",description:"这是我新建的文章",tag1:"",tag2:"",tag3:"",headImg:""}),o=(0,n.iH)(!1),d=(0,n.iH)({customToolbar:{icon:"save",title:"hover时显示的标题",action(e){}}}),i=(0,n.iH)(!1),g=(0,n.iH)([]),W=(0,n.iH)([]),_=(0,n.iH)(),k=(0,n.iH)(!0);function V(e){e&&(a.value.content+=`[](/${e.filePath})`)}async function h(){i.value=!0;try{var e=await r.ZP.$axios({url:"/user/headImg",method:"POST",headers:{token:!0}});e.success&&(g.value=e.result,W.value=g.value.map((e=>e.url)))}catch(e){}}function U(e,l,a){(new FormData).append("file",a),l({url:"/images/2.png",desc:"回显图片名称"})}(0,t.bv)((()=>{y()}));const b=(0,u.yj)(),y=async()=>{l.value=Number(b.query?.id)||0,0!==l.value&&(C("获取文章信息"),await s.Z.getMarkdown({id:l.value}).then((e=>{a.value=e.result,C("信息加载成功")})))};async function I(){0===l.value?(C("创建文章"),s.Z.createMarkdown(a.value).then((e=>{e.success&&(C(e.message),o.value=!1,setTimeout((()=>{k.value=!k.value}),1500))}))):(C("更新文章"),await s.Z.updateMarkdown({markdownData:a.value}).then((e=>{e.success?(C("数据更新"),y(),o.value=!1):C(e.msg)})))}function C(e,l){(0,c.xf)({message:e+(l||""),color:"yinzhu"})}return(e,l)=>{const u=(0,t.up)("ice-text"),n=(0,t.up)("ice-input"),c=(0,t.up)("ice-row"),r=(0,t.up)("ice-button");var s=(0,t.up)("v-md-editor"),b=(0,t.up)("el-drawer");const y=(0,t.up)("el-image");return k.value?((0,t.wg)(),(0,t.iD)("div",v,[(0,t.Wm)(c,{flexWrap:"",class:"article-info-container"},{default:(0,t.w5)((()=>[(0,t.Wm)(c,{width:"fit-content"},{default:(0,t.w5)((()=>[(0,t.Wm)(u,null,{default:(0,t.w5)((()=>[(0,t.Uk)(" 文章标题 ")])),_:1}),(0,t.Wm)(n,{modelValue:a.value.title,"onUpdate:modelValue":l[0]||(l[0]=e=>a.value.title=e)},null,8,["modelValue"])])),_:1}),(0,t.Wm)(c,{width:"fit-content"},{default:(0,t.w5)((()=>[(0,t.Wm)(u,null,{default:(0,t.w5)((()=>[(0,t.Uk)("文章描述")])),_:1}),(0,t.Wm)(n,{modelValue:a.value.description,"onUpdate:modelValue":l[1]||(l[1]=e=>a.value.description=e)},null,8,["modelValue"])])),_:1}),(0,t.Wm)(c,{width:"fit-content"},{default:(0,t.w5)((()=>[(0,t.Wm)(u,null,{default:(0,t.w5)((()=>[(0,t.Uk)("文章tag1")])),_:1}),(0,t.Wm)(n,{modelValue:a.value.tag1,"onUpdate:modelValue":l[2]||(l[2]=e=>a.value.tag1=e)},null,8,["modelValue"])])),_:1}),(0,t.Wm)(c,{width:"fit-content"},{default:(0,t.w5)((()=>[(0,t.Wm)(u,null,{default:(0,t.w5)((()=>[(0,t.Uk)("文章tag2")])),_:1}),(0,t.Wm)(n,{modelValue:a.value.tag2,"onUpdate:modelValue":l[3]||(l[3]=e=>a.value.tag2=e)},null,8,["modelValue"])])),_:1}),(0,t.Wm)(c,{width:"fit-content"},{default:(0,t.w5)((()=>[(0,t.Wm)(u,null,{default:(0,t.w5)((()=>[(0,t.Uk)("文章tag3")])),_:1}),(0,t.Wm)(n,{modelValue:a.value.tag3,"onUpdate:modelValue":l[4]||(l[4]=e=>a.value.tag3=e)},null,8,["modelValue"])])),_:1}),(0,t.Wm)(r,{onClick:l[5]||(l[5]=e=>o.value=!1)},{default:(0,t.w5)((()=>[(0,t.Uk)("再想想")])),_:1}),(0,t.Wm)(r,{onClick:I},{default:(0,t.w5)((()=>[(0,t.Uk)("提交")])),_:1}),(0,t.Wm)(r,{onClick:h},{default:(0,t.w5)((()=>[(0,t.Uk)("选择头图")])),_:1}),(0,t.Wm)(m,{action:"/file/markdownImages",data:_.value,onResult:V},null,8,["data"])])),_:1}),(0,t.Wm)(s,{"include-level":[1,2,3,4,5],onSave:l[6]||(l[6]=e=>o.value=!0),modelValue:a.value.content,"onUpdate:modelValue":l[7]||(l[7]=e=>a.value.content=e),"disabled-menus":[],onUploadImage:U,autofocus:!0,toolbar:d.value},null,8,["modelValue","toolbar"]),(0,t.Wm)(b,{modelValue:o.value,"onUpdate:modelValue":l[14]||(l[14]=e=>o.value=e),title:"填写关于该文章的其他信息",size:"70%",direction:"ttb","with-header":!1},{default:(0,t.w5)((()=>[(0,t.Wm)(c,{flexWrap:""},{default:(0,t.w5)((()=>[(0,t.Wm)(c,{width:"fit-content"},{default:(0,t.w5)((()=>[(0,t.Wm)(u,null,{default:(0,t.w5)((()=>[(0,t.Uk)(" 文章标题 ")])),_:1}),(0,t.Wm)(n,{modelValue:a.value.title,"onUpdate:modelValue":l[8]||(l[8]=e=>a.value.title=e)},null,8,["modelValue"])])),_:1}),(0,t.Wm)(c,{width:"fit-content"},{default:(0,t.w5)((()=>[(0,t.Wm)(u,null,{default:(0,t.w5)((()=>[(0,t.Uk)("文章描述")])),_:1}),(0,t.Wm)(n,{modelValue:a.value.description,"onUpdate:modelValue":l[9]||(l[9]=e=>a.value.description=e)},null,8,["modelValue"])])),_:1}),(0,t.Wm)(c,{width:"fit-content"},{default:(0,t.w5)((()=>[(0,t.Wm)(u,null,{default:(0,t.w5)((()=>[(0,t.Uk)("文章tag1")])),_:1}),(0,t.Wm)(n,{modelValue:a.value.tag1,"onUpdate:modelValue":l[10]||(l[10]=e=>a.value.tag1=e)},null,8,["modelValue"])])),_:1}),(0,t.Wm)(c,{width:"fit-content"},{default:(0,t.w5)((()=>[(0,t.Wm)(u,null,{default:(0,t.w5)((()=>[(0,t.Uk)("文章tag2")])),_:1}),(0,t.Wm)(n,{modelValue:a.value.tag2,"onUpdate:modelValue":l[11]||(l[11]=e=>a.value.tag2=e)},null,8,["modelValue"])])),_:1}),(0,t.Wm)(c,{width:"fit-content"},{default:(0,t.w5)((()=>[(0,t.Wm)(u,null,{default:(0,t.w5)((()=>[(0,t.Uk)("文章tag3")])),_:1}),(0,t.Wm)(n,{modelValue:a.value.tag3,"onUpdate:modelValue":l[12]||(l[12]=e=>a.value.tag3=e)},null,8,["modelValue"])])),_:1})])),_:1}),(0,t.Wm)(r,{onClick:l[13]||(l[13]=e=>o.value=!1)},{default:(0,t.w5)((()=>[(0,t.Uk)("再想想")])),_:1}),(0,t.Wm)(r,{onClick:I},{default:(0,t.w5)((()=>[(0,t.Uk)("提交")])),_:1})])),_:1},8,["modelValue"]),(0,t.Wm)(b,{modelValue:i.value,"onUpdate:modelValue":l[15]||(l[15]=e=>i.value=e),title:"选择你的头图",size:"90%",direction:"ttb","with-header":!1},{default:(0,t.w5)((()=>[(0,t.Uk)(" 选择你的头图 "),(0,t._)("div",f,[((0,t.wg)(!0),(0,t.iD)(t.HY,null,(0,t.Ko)(g.value,((e,l)=>((0,t.wg)(),(0,t.iD)("div",{key:l,class:"demo-image__preview",onClick:l=>{var t;t=e.url,a.value.headImg=t}},[(0,t.Wm)(y,{src:e.url,lazy:"",fit:"cover","preview-src-list":W.value,"initial-index":l,"hide-on-click-modal":!0,"close-on-press-escape":!0},null,8,["src","preview-src-list","initial-index"])],8,w)))),128))])])),_:1},8,["modelValue"])])):((0,t.wg)(),(0,t.iD)("div",p,[(0,t.Wm)(u,null,{default:(0,t.w5)((()=>[(0,t.Uk)(" 已经创建成功了,请回到首页查看 ")])),_:1})]))}}},[["__scopeId","data-v-635d178c"]])}}]);