"use strict";(self.webpackChunkblogfront=self.webpackChunkblogfront||[]).push([[864],{9262:function(e,a,l){l.d(a,{Z:function(){return n}});var t=l(3396),o=l(2483);const r={class:"left"},u=["@click"],s={class:"left"};a={__name:"Avatar",props:{email:{type:String,request:!0},imgUrl:String,allowClick:{type:Boolean,default:!0}},setup(e){const a=(0,o.tv)(),l=e,n=e=>{l.allowClick&&(e=a.resolve({path:"/user/about",query:{email:e}}),window.open(e.href,"_blank"))};return(a,l)=>{var o=(0,t.up)("ice-avatar");return e.allowClick?((0,t.wg)(),(0,t.iD)("div",{key:0,class:"demo-type",onClick:l[0]||(l[0]=a=>n(e.email))},[(0,t._)("div",r,[(0,t.Wm)(o,{src:e.imgUrl,class:"shadow"},null,8,["src"])])])):((0,t.wg)(),(0,t.iD)("div",{key:1,class:"demo-type","@click":e.allowClick?null:n(e.email)},[(0,t._)("div",s,[(0,t.Wm)(o,{src:e.imgUrl,class:"shadow"},null,8,["src"])])],8,u))}}};var n=(0,l(89).Z)(a,[["__scopeId","data-v-74c830d4"]])},3864:function(e,a,l){l.r(a),l.d(a,{default:function(){return p}});var t=l(3396);a=e=>((0,t.dD)("data-v-7e6ef452"),e=e(),(0,t.Cn)(),e);const o={class:"editUser container"},r={class:"form"},u=a((()=>(0,t._)("div",{style:{margin:"20px"}},null,-1))),s={class:"avatar"},n={class:"upload"},d=["src"],m=a((()=>(0,t._)("form",{action:"/file/avatar"},null,-1))),i={class:"achievement"};var c=l(9324);a=l(9262);const f={key:0,class:"alert"};var w={name:"Alert",props:["msg","show"]},p=(l=l(89),a={name:"EditUser",data(){return{userInfo:{},markdownData:{},imageUrl:"",imgData:"",token:{token:"demotoken"},alertInf:"",showAlert:!1}},components:{Avatar:a.Z,Alert:(0,l.Z)(w,[["render",function(e,a,l,o,r,u){var s=(0,t.up)("el-alert");return l.show?((0,t.wg)(),(0,t.iD)("div",f,[(0,t.Wm)(s,{title:l.msg,type:"info",center:"","show-icon":""},null,8,["title"])])):(0,t.kq)("",!0)}],["__scopeId","data-v-f994ff96"]])},methods:{async handleAvatarSuccess(){var e=await c.ZP.$axios({url:"/user/getUserInfByToken",method:"POST",headers:{token:!0}});e=JSON.stringify(e.result.res);localStorage.setItem("userInfo",e)},beforeAvatarUpload(){},async initUserData(){var e=await c.ZP.$axios({url:"/user/userInf",method:"POST",headers:{token:!0}});e.success&&(this.userInfo=e.result.res,this.markdownData=e.result.markdown)},async submitForm(){var e=await c.ZP.$axios({url:"/user/updateUserInf",method:"POST",headers:{token:!0},data:{...this.userInfo}});e.success?this.alertInf=e.message||"更新成功":this.alertInf=e.message||"更新失败",this.showAlert=!0}},created(){this.initUserData();var e=JSON.parse(localStorage.getItem("userInfo"));this.token=e.token}},(0,l.Z)(a,[["render",function(e,a,l,c,f,w){const p=(0,t.up)("Avatar"),v=(0,t.up)("Plus"),k=(0,t.up)("el-icon"),g=(0,t.up)("el-upload"),h=(0,t.up)("el-input"),b=(0,t.up)("el-form-item");var V=(0,t.up)("el-form"),I=(0,t.up)("el-button"),_=(0,t.up)("Alert");return(0,t.wg)(),(0,t.iD)("div",o,[(0,t._)("div",r,[u,(0,t.Wm)(V,{"label-width":"100px"},{default:(0,t.w5)((()=>[(0,t._)("div",s,[(0,t.Wm)(p,{imgUrl:f.userInfo.avatar},null,8,["imgUrl"]),(0,t._)("div",n,[(0,t.Wm)(g,{class:"avatar-uploader",data:{token:f.token},action:"/file/avatar","show-file-list":!0,"on-success":w.handleAvatarSuccess,"before-upload":w.beforeAvatarUpload},{default:(0,t.w5)((()=>[f.imageUrl?((0,t.wg)(),(0,t.iD)("img",{key:0,src:f.imageUrl,class:"avatar"},null,8,d)):((0,t.wg)(),(0,t.j4)(k,{key:1,class:"avatar-uploader-icon"},{default:(0,t.w5)((()=>[(0,t.Wm)(v)])),_:1}))])),_:1},8,["data","on-success","before-upload"]),m])]),(0,t.Wm)(b,{label:"avatar"},{default:(0,t.w5)((()=>[(0,t.Wm)(h,{modelValue:f.userInfo.avatar,"onUpdate:modelValue":a[0]||(a[0]=e=>f.userInfo.avatar=e)},null,8,["modelValue"])])),_:1}),(0,t.Wm)(b,{label:"id"},{default:(0,t.w5)((()=>[(0,t.Wm)(h,{modelValue:f.userInfo.id,"onUpdate:modelValue":a[1]||(a[1]=e=>f.userInfo.id=e),disabled:"true"},null,8,["modelValue"])])),_:1}),(0,t.Wm)(b,{label:"Name"},{default:(0,t.w5)((()=>[(0,t.Wm)(h,{modelValue:f.userInfo.username,"onUpdate:modelValue":a[2]||(a[2]=e=>f.userInfo.username=e)},null,8,["modelValue"])])),_:1}),(0,t.Wm)(b,{label:"email"},{default:(0,t.w5)((()=>[(0,t.Wm)(h,{modelValue:f.userInfo.email,"onUpdate:modelValue":a[3]||(a[3]=e=>f.userInfo.email=e),disabled:"true"},null,8,["modelValue"])])),_:1}),(0,t.Wm)(b,{label:"occupation"},{default:(0,t.w5)((()=>[(0,t.Wm)(h,{modelValue:f.userInfo.occupation,"onUpdate:modelValue":a[4]||(a[4]=e=>f.userInfo.occupation=e)},null,8,["modelValue"])])),_:1}),(0,t.Wm)(b,{label:"githubUrl"},{default:(0,t.w5)((()=>[(0,t.Wm)(h,{modelValue:f.userInfo.githubUrl,"onUpdate:modelValue":a[5]||(a[5]=e=>f.userInfo.githubUrl=e)},null,8,["modelValue"])])),_:1}),(0,t.Wm)(b,{label:"word"},{default:(0,t.w5)((()=>[(0,t.Wm)(h,{modelValue:f.userInfo.word,"onUpdate:modelValue":a[6]||(a[6]=e=>f.userInfo.word=e)},null,8,["modelValue"])])),_:1}),(0,t.Wm)(b,{label:"createdAt"},{default:(0,t.w5)((()=>[(0,t.Wm)(h,{modelValue:f.userInfo.createdAt,"onUpdate:modelValue":a[7]||(a[7]=e=>f.userInfo.createdAt=e),disabled:"true"},null,8,["modelValue"])])),_:1})])),_:1})]),(0,t._)("div",i,[(0,t.Wm)(V,{"label-width":"100px"},{default:(0,t.w5)((()=>[(0,t.Wm)(b,{label:"浏览量"},{default:(0,t.w5)((()=>[(0,t.Wm)(h,{modelValue:f.markdownData.allView,"onUpdate:modelValue":a[8]||(a[8]=e=>f.markdownData.allView=e),disabled:"true"},null,8,["modelValue"])])),_:1}),(0,t.Wm)(b,{label:"文章数量"},{default:(0,t.w5)((()=>[(0,t.Wm)(h,{modelValue:f.markdownData.allNums,"onUpdate:modelValue":a[9]||(a[9]=e=>f.markdownData.allNums=e),disabled:"true"},null,8,["modelValue"])])),_:1}),(0,t.Wm)(b,{label:"点赞数量"},{default:(0,t.w5)((()=>[(0,t.Wm)(h,{modelValue:f.markdownData.diggCounts,"onUpdate:modelValue":a[10]||(a[10]=e=>f.markdownData.diggCounts=e),disabled:"true"},null,8,["modelValue"])])),_:1})])),_:1})]),(0,t.Wm)(I,{onClick:w.submitForm},{default:(0,t.w5)((()=>[(0,t.Uk)("提交一下!")])),_:1},8,["onClick"]),(0,t.Wm)(_,{msg:f.alertInf,show:f.showAlert},null,8,["msg","show"])])}],["__scopeId","data-v-7e6ef452"]]))}}]);